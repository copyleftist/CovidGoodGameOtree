{% extends "global/Page.html" %}


{% block content %}
    <div id="main" class="container fade-in">
        <div class="row">
            <div class="col">

                <div style="margin-left: 35%;color: gray;font-weight: bolder;">You <br> â†™</div>
                <div class="box">
                    <img src="{% static player_character %}">
                    <div class="text-centered">{{ player.participant.multiplier }}</div>
                </div>
            </div>
            <div class="col">
            </div>
        </div>
        <br>
        <br>
        <p>
            Your multiplier is {{ player.participant.multiplier }}. <br>
            <b>Do you want to disclose your multiplier to the other player?</b>
        </p>
        <br>
        <br>
        <div class="row">
            <div class="col" align="center">
                <button type="button" class="drawn-button" id="disc">DISCLOSE</button>
            </div>
            <div class="col" align="center">
                <button type="button" class="drawn-button" id="hide">HIDE</button>
            </div>
        </div>
        {#        <input type="hidden" id="disclose" name="disclose"/>#}
        {#        <input type="hidden" id="RT" name="RT"/>#}

    </div>

    <script>

        $(document).ready(function () {
            let startTime = Date.now();
            let RT;
            let disclose;

            let templateWait = `{{ html }}`;

            $('#disc').click(function () {
                choice(1, startTime);
            });

            $('#hide').click(function () {
                choice(0, startTime);
            });

            function choice(value, startTime) {

                RT = Date.now() - startTime;
                console.log(RT);
                disclose = value;

                $('#main').append(templateWait);
                $("#modalWait").modal({
                    backdrop: 'static',
                    keyboard: false
                });
                $('#modalWait').modal('show');

                var startTime = Date.now();

                setInterval(function () {
                    liveSend(
                        {
                            time: Date.now() - startTime,
                            RT: RT,
                            disclose: disclose
                        });
                }, 2000);

                setInterval(function () {
                        var wait = document.getElementById("wait");

                        if (wait.innerHTML.length >= 3)
                            wait.innerHTML = "";
                        else
                            wait.innerHTML += ".";

                    },
                    500);

            }


        });

        function liveRecv(data) {
            if (data === true) {
                {#console.log('RT = ' + RT);#}
                {#console.log('Disclose = ' + disclose);#}
                {#$('#RT').val(RT);#}
                {#$('#disclose').val(disclose);#}
                $('#main').fadeOut(140);
                $('#form').submit();
            }
        }


    </script>


{% endblock %}
